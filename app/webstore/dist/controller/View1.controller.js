sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/core/Fragment","sap/m/MessageToast","sap/m/MessageBox"],(e,t,o,s)=>{"use strict";return e.extend("webstore.webstore.controller.View1",{onInit(){},onAfterRendering:function(){const e=this.byId("storesTable");e.attachUpdateFinished(this._updateStoreCount,this);this._updateStoreCount()},onSearch(e){const t=(e.getParameter("newValue")||e.getParameter("query")||"").trim();const o=this.byId("storesTable");const s=o.getBinding("items");if(!s)return;const r=[];if(t){r.push(new sap.ui.model.Filter("name",sap.ui.model.FilterOperator.Contains,t))}s.filter(r)},_updateStoreCount(){const e=this.byId("storesTable");const t=e.getBinding("items");if(!t)return;const o=t.getLength();this.byId("storesTitle").setText(`Stores (${o})`)},_oCreateDialog:null,onCreateStore:async function(){const e=this.getView();const o=e.getModel("ui");o.setProperty("/newStoreName","");o.setProperty("/companyCode","");o.setProperty("/salesOrg","");o.setProperty("/distChan","");o.setProperty("/divsion","");if(!this._oCreateDialog){this._oCreateDialog=await t.load({id:e.getId(),name:"webstore.webstore.view.fragments.CreateStoreDialog",controller:this});e.addDependent(this._oCreateDialog)}this._oCreateDialog.open()},onCancelCreateStore:function(){this._oCreateDialog.close()},onConfirmCreateStore:async function(){const e=this.getView();const t=e.getModel();const r=(e.getModel("ui").getProperty("/newStoreName")||"").trim();const n=(e.getModel("ui").getProperty("/companyCode")||"").trim();const a=(e.getModel("ui").getProperty("/salesOrg")||"").trim();const i=(e.getModel("ui").getProperty("/distChan")||"").trim();const c=(e.getModel("ui").getProperty("/divsion")||"").trim();if(!r){s.warning("Please enter a store name");return}try{const s=this.byId("storesTable");const g=s.getBinding("items");const l=g.create({name:r,companyCode:n,salesOrg:a,distributionChannel:i,division:c,active:true});await t.submitBatch("changes");await l.created();g.refresh();this._oCreateDialog.close();e.getModel("ui").setProperty("/newStoreName","");o.show("Store created")}catch(e){s.error(e.message||"Create failed")}},onDeleteStore:async function(){const e=this.byId("storesTable");const t=e.getSelectedItems();if(!t.length){sap.m.MessageToast.show("Select at least one store to delete.");return}const o=this.getView().getModel();try{t.forEach(e=>{const t=e.getBindingContext();if(t){t.delete("changes")}});await o.submitBatch("changes");e.removeSelections(true);sap.m.MessageToast.show("Deleted selected store(s).")}catch(e){sap.m.MessageBox.error(e.message||"Delete failed")}},onSave:async function(){const e=this.getView().getModel();try{await e.submitBatch("changes");o.show("Saved")}catch(e){s.error(e.message||"Save failed")}},onStorePress:function(e){const t=e.getSource().getParent();const o=t.getBindingContext();const s=o.getProperty("ID");this.getOwnerComponent().getRouter().navTo("store",{ID:s})}})});
//# sourceMappingURL=View1.controller.js.map